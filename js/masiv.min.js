!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.M=b()}(this,function(){function l(){var g,h,i,j,k,a=this,d=a.classList;return d.contains(f)||a.hasAttribute("disabled")?!1:(g=a.querySelector("."+c+"dropmenu"))?(d.add(f),h=a.getBoundingClientRect(),i="",d.contains(c+"select")?(j=a.querySelector("."+c+"input"),g["onclick"]=function(b){for(var d,c=b.target;c!==g;){if(c.matches("[data-value]")){d=g.querySelector("[selected]"),d&&d.removeAttribute("selected"),j.value=c.dataset.value||"",c.setAttribute("selected","selected");break}c=c.parentNode}return B(a,!1),!1}):(k=(g.offsetWidth-h.width)/2,i+=h.left+g.offsetWidth<b.body.clientWidth?"":h.right+k<b.body.clientWidth?"left: -"+k+"px;":"right: 0"),g.style.cssText=i,d.add(e),void 0):!1}function m(){var a,c=!1;j(b).on("mousedown","[masiv-drag]",function(b){var d,e,f,g,h,i;for(b=b.touches?b.touches[0]:b,c=!0,d=this.getAttribute("masiv-drag")-0,e=this;d--;)e=e.parentNode;f=window.getComputedStyle(e),g=f.getPropertyValue("left").slice(0,-2)-0,h=f.getPropertyValue("top").slice(0,-2)-0,i=f.getPropertyValue("position"),i="static"===i?"relative":i,g=isNaN(g)?0:g,h=isNaN(h)?0:h,e.setAttribute("masiv-dragging",!0),a={x:b.clientX,y:b.clientY,target:e,position:i,left:g,top:h}}).on("mousemove",function(b){c&&n.call(a,b)},{passive:!1}).on("mouseup",function(){a&&(c=!1,a.target.removeAttribute("masiv-dragging")),a=null})}function n(a){var b,c,d,e;return a.preventDefault(),a=a.touches?a.touches[0]:a,b=a.clientX,c=a.clientY,b=b>window.innerWidth?window.innerWidth:b,b=0>b?0:b,d=this.left+b-this.x,e=this.top+c-this.y,this.target.style.cssText="left:"+d+"px;top:"+e+"px;position:"+this.position,!1}function o(a){var g,i,j,k,b=a.parentNode,d=b.classList.contains(c+"backdrop");if(d)a.dispatchEvent(h.beforeOpen),B(b,!0);else{if(g=a.classList,g.contains(f))return;a.dispatchEvent(h.beforeOpen),g.add(f),g.add(c+"transless"),a.style.cssText="",i=a.getBoundingClientRect(),j=b.scrollTop+(i.height>=b.clientHeight?0:(b.clientHeight-i.height)/2),k=b.scrollLeft+(i.width>=b.clientWidth?0:(b.clientWidth-i.width)/2),a.style.cssText="left:"+k+"px;top:"+j+"px;",a.offsetWidth,g.remove(c+"transless"),a.classList.add(e)}a.dispatchEvent(h.open)}function p(a){var b,d;a&&(a.dispatchEvent(h.beforeClose),b=a.parentNode,d=b.classList.contains(c+"backdrop"),d?B(b,!1):B(a,!1),a.dispatchEvent(h.close))}function q(a){var h,i,k,l,m,n,o,p,q,r,s,e=a.html||this.getAttribute("masiv-tip"),f=j.pos(this),g=b.createElement("DIV");g.innerHTML=e+'<div class="'+c+'tip-diamond"></div>',g.className=c+"tip"+(a.color?" "+a.color:""),b.body.appendChild(g),h=g.offsetHeight,i=g.offsetWidth,k=b.body.clientWidth,l=this.offsetWidth,m=(i-l)/2,n=f.left+l+m+10>k,o=f.left>=m+10,p=f.top>=h+40,q=p?f.top-h-10:f.top+h+10,r=o?n?k-i-10:f.left-m:10,s=g.lastChild,s.style.cssText="left:"+(o?f.left-r+l/2:n?i/2:f.left+l/2-10)+"px;top:"+(p?"100%;":"0;"),g.style.cssText="left:"+r+"px;top:"+q+"px;opacity:1;",this.addEventListener(a.deactive,function(){g.style.opacity=0,setTimeout(function(){g&&g.remove()},d)})}function r(a){for(var e,g,i,j,c=a.target,d=this;c!==d;){if(c.matches("[masiv-tab]")){if(c.classList.contains(f))return!1;e=d.getAttribute("masiv-tabs"),g=d.querySelector("[masiv-tab]."+f),i=b.querySelector('[masiv-taber="'+e+'"].'+f),j=b.querySelector('[masiv-taber="'+e+'"][masiv-tab="'+c.getAttribute("masiv-tab")+'"]'),g&&g.classList.remove(f),i&&i.classList.remove(f),i.dispatchEvent(h.close),c.classList.add(f),j&&j.classList.add(f),j.dispatchEvent(h.open);break}c=c.parentNode}}function s(a){for(var e,g,b=a.target,d=this;b!==d;){if(b.matches("."+c+"question")){e="one"===d.getAttribute("masiv-collapse"),e&&!b.classList.contains(f)&&(g=d.querySelector("."+c+"question."+f),g&&g.classList.remove(f)),b.classList.toggle(f);break}b=b.parentNode}}function t(a){var d,f,g,h;if(!a)return!1;if(1===a.nodeType)return u(a),!1;if(a="string"==typeof a?{html:a}:a,a=y({timeout:2019,max:3,dismiss:i.click},a),d=b.getElementsByClassName(c+"messages")[0],d||(d=b.createElement("DIV"),d.className=c+"messages",b.body.append(d)),f=b.createElement("DIV"),f.className=c+(a.color?"message "+a.color:"message"),f.innerHTML=a.html,g=d.children,h=g.length,a.max&&a.max<=h)for(;h>=a.max;)--h,u(g[h]);return h>0?d.insertBefore(f,g[0]):d.append(f),f.offsetWidth,f.classList.add(e),a.dismiss&&(a.timeout&&setTimeout(function(){u(f)},a.timeout),f.addEventListener(a.dismiss,function(){u(f)})),f}function u(a){a&&(a.classList.remove(e),setTimeout(function(){a.remove()},d))}function v(a,b,d){var e,g,h,j,k,l,m,n;if(a-=0,b-=0,e="",g={siblings:2,pageClass:c+"page",active:f,dots:"┅"},d?(g=y(g,d),this.$settings=g):g=this.$settings||g,h=g.siblings,j=g.href,h===!1)return k=a>1?a-1:1,l=a===b?b:a+1,e+=w(g.pageClass+" "+c+"page-prev",k,g.prev?g.prev:"上页",j),e+=w(g.pageClass+" "+c+"page-next",l,g.next?g.next:"下页",j),this.innerHTML=e,void 0;for(e="<a"+(j?' href="'+j+a+'"':"")+' class="'+g.pageClass+" "+g.active+'">'+a+"</a>",++h,m=1;h>m;m++)k=a-m,l=a+m,k>1&&(e=w(g.pageClass,k,k,j)+e),b>l&&(e+=w(g.pageClass,l,l,j));if(a-h>1?e=w(g.pageClass,1,1,j)+'<span class="'+c+'page-dots">'+g.dots+"</span>"+e:1!=a&&(e=w(g.pageClass,1,1,j)+e),b>a+h?e+='<span class="'+c+'page-dots">'+g.dots+"</span>"+w(g.pageClass,b,b,j):a!=b&&(e+=w(g.pageClass,b,b,j)),g.prev&&(k=a>1?a-1:1,e=w(g.pageClass+" "+c+"page-prev",k,g.prev?g.prev:"上页",j)+e),g.next&&(l=a===b?b:a+1,e+=w(g.pageClass+" "+c+"page-next",l,g.next?g.next:"下页",j)),this.innerHTML=e,"function"==typeof g.click){if(n=this.$clickfn)return;this.$clickfn=n=function(a){for(var b=a.target;b!==this;){if(b.matches("[data-page]")){g.click.call(b,b.dataset.page-0,b);break}b=b.parentNode}},this.addEventListener(i.click,n)}}function w(a,b,c,d){return"<a"+(d?' href="'+d+b+'"':"")+' class="'+a+'" data-page="'+b+'">'+c+"</a>"}function x(a){var d,e,b=0,c=this.length;if(c)for(;c>b;b++)a.call(this[b],this[b],b);else if(0!==c)for(d=Object.keys(this),c=d.length;c>b;b++)e=d[b],a.call(this[e],this[e],e,b);return this}function y(){var e,f,a=1,b=arguments.length,c=arguments[0],d=arguments[b-1]===!1;if(1>b)return this;for("boolean"==typeof arguments[b-1]&&--b;b>a;a++){e=arguments[a];for(f in e)d&&f in c||(c[f]=e[f])}return c}function z(a,b,c){var d,e=!0;return b||(b=250),function(){var f=arguments,g=this;c?e?(a.apply(g,f),e=!1):(d&&clearTimeout(d),d=setTimeout(function(){e=!0},b)):(d&&clearTimeout(d),d=setTimeout(function(){a.apply(g,f)},b))}}function A(a,b,c){var d,e=!0;return b||(b=250),function(){var f=arguments,g=this;d&&clearTimeout(d),e?(a.apply(g,f),e=!1,setTimeout(function(){e=!0},b)):c!==!0&&(d=setTimeout(function(){a.apply(g,f)},b))}}function B(a,b){var c=a.classList;a.getAttribute("masiv-toggable")||(a.setAttribute("masiv-toggable",!0),b?(c.add(f),a.offsetWidth,c.add(e),a.removeAttribute("masiv-toggable")):(c.remove(e),setTimeout(function(){c&&c.remove(f),a.removeAttribute("masiv-toggable")},d)))}function C(a){var b,c,d;if(a&&a.url){a=y({method:"GET",asyn:!0,data:{},headers:{}},a),b=new XMLHttpRequest,b.open(a.method,a.url,a.asyn),d=a.headers;for(c in d)b.setRequestHeader(c,d[c]);b.onreadystatechange=function(){4===b.readyState&&(200===b.status&&a.success?a.success(b.responseText):a.error&&a.error(b),a.complete&&a.complete(),b=null)},b.send(a.data)}}function D(a){var c,d;for("string"==typeof a&&(a=b.querySelector(a)),c=a.offsetTop,d=a.offsetLeft;a.offsetParent;)a=a.offsetParent,c+=a.offsetTop,d+=a.offsetLeft;return{top:c,left:d}}function E(a){return h[a]=new CustomEvent(a,{bubbles:!0,cancelable:!0})}function F(a,b,c){if(a.getDate){var d={Y:a.getFullYear(),M:a.getMonth()+1,D:a.getDate(),h:a.getHours(),m:a.getMinutes(),s:a.getSeconds()};return b=b||"Y-M-D h:m:s",b.replace(/Y|M|D|h|m|s/g,function(a){return a=d[a],c!==!1&&10>a?"0"+a:a})}return console.error(a,"is not an instance of Date()"),!1}function G(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=0|(a+16*Math.random())%16;return a=Math.floor(a/16),("x"===b?c:8|7&c).toString(16)})}var j,k,a=this,b=a.document,c=b.body.getAttribute("masiv-namespace")||"",d=200,e="msv-in",f="msv-active",g="ontouchend"in b,h={beforeOpen:new CustomEvent("beforeOpen",{bubbles:!0,cancelable:!0}),open:new CustomEvent("open",{bubbles:!0,cancelable:!0}),beforeClose:new CustomEvent("beforeClose",{bubbles:!0,cancelable:!0}),close:new CustomEvent("close",{bubbles:!0,cancelable:!0})},i={ready:"DOMContentLoaded",mousewheel:/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel",mousedown:g?"touchstart":"mousedown",mouseup:g?"touchend":"mouseup",mousemove:g?"touchmove":"mousemove",click:g?"tap":"click"};return g&&function(){E("tap"),E("swipeLeft"),E("swipeRight"),E("swipeUp"),E("swipeDown"),E("press");var a={};b.addEventListener("touchstart",function(b){var c=b.touches[0];a={x:c.clientX,y:c.clientY,time:Date.now(),dx:0,dy:0}}),b.addEventListener("touchmove",A(function(b){var c=b.touches[0];a.dx=c.clientX-a.x,a.dy=c.clientY-a.y},100)),b.addEventListener("touchend",function(b){var c=Date.now()-a.time,d=b.target,e=12;Math.abs(a.dx)<e&&Math.abs(a.dy)<e?(240>c&&d.dispatchEvent(h.tap),c>1e3&&d.dispatchEvent(h.press)):(a.dx>e&&d.dispatchEvent(h.swipeRight),a.dx<-e&&d.dispatchEvent(h.swipeLeft),a.dy>e&&d.dispatchEvent(h.swipeDown),a.dy<-e&&d.dispatchEvent(h.swipeUp)),a={}})}(),j=function(a){return new k(a)},j.extend=j.prototype.extend=y,k=function(a,c){var d,e,f,g,h;if(!a)return this;if(d=this,c=c||b,"function"==typeof a)return c.addEventListener(i.ready,a),c;if("string"==typeof a){if("<"===a[0])return e=b.createElement("DIV"),e.innerHTML=a,j(e.children);for(f=c.querySelectorAll(a),g=0,h=f.length;h>g;g++)d[g]=f[g];d.length=h}else if(a.length){for(g=0,h=a.length;h>g;g++)d[g]=a[g];d.length=h}else a.nodeType?(d[0]=a,d.length=1):y(d,a);return d},k.prototype={each:x,on:function(a,b,c,d){return a=i[a]||a,"string"==typeof b?this.each(function(e){e.addEventListener(a,function(a){for(var d=a.target;d!==e;)d.matches(b)&&c.call(d,a),d=d.parentNode},d)}):this.each(function(d){d.addEventListener(a,b,c)}),this},off:function(a,b){return a=i[a]||a,this.each(function(c){c.removeEventListener(a,b)})},fire:function(a){return a=i[a]||a,this.each(function(b){h[a]=h[a]||new CustomEvent(a,{bubbles:!0,cancelable:!0}),b.dispatchEvent(h[a])})},tip:function(a){var b={active:"mouseenter",deactive:"mouseleave"};return a&&(b=y(b,a)),this.each(function(a){a.addEventListener(b.active,function(){q.call(a,b)})})},dialog:function(a){return this.each(function(b){a===!1?p(b):o(b)})},collapse:function(){return this.on(i.click,s)},tabs:function(){return this.on(i.click,r)},page:function(a,b,c){return this.each(function(d){v.call(d,a,b,c)})},toggle:function(a){return this.each(function(b){B(b,a)})}},j.extend(j,{version:"1.0",MASIV:k.prototype,message:t,ajax:C,debounce:z,throttle:A,pos:D,time:F,guid:G,eventAlias:i}),j(b).on(i.click,function(a){for(var d=a.target;9!==d.nodeType;){switch(!0){case d.matches("."+c+"dropmenu"):d=b.documentElement;break;case d.matches("[masiv-dropmenu]"):j("[masiv-dropmenu]."+f).each(function(a){B(a,!1)}),d.classList.contains(f)?B(d,!1):l.call(d),d=b.documentElement;break;case d===b.body:j("[masiv-dropmenu]."+f).each(function(a){B(a,!1)});break;case d.matches("[masiv-dialog]"):j(d.getAttribute("masiv-dialog")).dialog(),d=b.documentElement}d=d.parentNode}d=null}).on(i.click,function(a){var c=a.target;switch(!0){case c.matches("[masiv-dismiss]"):p(b.querySelector(c.getAttribute("masiv-dismiss")||"MASIV"))}c=null},!0),j("[masiv-sidebar]").on(i.click,function(){var a=b.querySelector(this.getAttribute("masiv-sidebar"));B(a,!a.classList.contains(f))}),j("."+c+"sidebar").on(i.click,function(a){a.target===this&&B(this,!1)},!0),j("[masiv-tabs]").tabs(),j("[masiv-collapse]").collapse(),j("[masiv-tip]").tip(),b.querySelector("[masiv-drag]")&&m(),j});